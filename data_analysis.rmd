---
title: "Autism Screening Data Analysis Project"
output:
  pdf_document: default
  html_document: default
date: "2025-11-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(tidyverse)
library(ggplot2)
library(plotly)
```

# About data analysis
The aim of this study is to explore how demographic factors (gender, ethnicity, and family autism history) and individual AQ-10 item responses relate to autism classification in adults.

## Research questions:
* Which of the ten AQ-10 items (A1–A10) are most strongly associated with an autism diagnosis?
* Is there a difference in the distribution of autism diagnoses between genders?
* Do males and females with autism differ in their average AQ-10 total scores?
* Does the prevalence of autism vary across different ethnic groups?
* Is having a family history of autism associated with higher AQ-10 scores?

# Loading data and initial data exploration

```{r}
df <- read.csv("./dataset/Autism Screening.csv")
```

```{r}
head(df)
```

```{r}
names(df)
```
Check the dimensions: the dataset consists of 704 observations and 21 variables.
```{r}
dim(df)
```

Convert to data table
```{r}
dt <- as.data.table(df)
```

Examine the structure of the data 
```{r}
str(dt)
```

# Data preprocessing

Select variables of interest
```{r}
dt <- dt[, c("A1_Score", "A2_Score", "A3_Score","A4_Score", "A5_Score", "A6_Score","A7_Score", "A8_Score", "A9_Score","A10_Score", "gender","ethnicity", "austim", "contry_of_res", "result", "Class.ASD")]
```

Check for missing values
```{r}
colSums(is.na(dt))
```
Convert gender and autism to factor
```{r}
dt[, gender := as.factor(gender)]
```

Convert class to numeric
```{r}
dt$Class.ASD <- ifelse(dt$Class.ASD == "YES", 1, 0)
```

## Distribution of gender
```{r}
ggplot(dt, aes(x=gender, fill=gender)) + 
  geom_bar(color="black") + 
  scale_fill_discrete(
    labels=c("f"="Female", "m"="Male")
  ) + 
  scale_x_discrete(
    labels=c("f"="Female", "m"="Male")
  ) + 
  ggtitle("Distribution of gender among participants")
```
## Distribution of ethnicity
```{r}
ggplot(dt, aes(x=ethnicity, fill=ethnicity)) + 
  geom_bar(color="black") + 
  ggtitle("Distribution of ethnicity among participants") +
  theme(axis.text.x = element_text(angle=60, hjust=1))
```
## Distribution of autistic vs. non-autistic participants
```{r}
ggplot(dt, aes(x=Class.ASD, fill=as.factor(Class.ASD))) + 
  geom_bar(color="black") +
  labs(
    title = "Distribution of autistic vs. non-autistic participants",
    fill = "Group"
  ) + 
  scale_fill_discrete(
    labels=c("0"="Non-autistic", "1"="Autistic")
  ) + 
  scale_x_discrete(labels=none) +
  xlab("")
```

# Data Analysis

## Which of the ten AQ-10 items (A1–A10) are most strongly associated with an autism diagnosis?

```{r}
correlations <- sapply(dt[, 1:10], function(x) cor(x, dt[[16]]))
```

```{r}
correlations
```

```{r}
corr <- data.frame(
  A_Score=names(correlations),
  Correlation=as.numeric(correlations)
)
```

```{r}
corr$A_Score <- factor(corr$A_Score, levels = corr$A_Score)
```


```{r}
ggplot(corr, aes(x=A_Score, y=Correlation, fill=A_Score)) + 
  geom_bar(stat = "identity", color="black") + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

## Is there a difference in the distribution of autism diagnoses between genders?

Perform ANOVA test to examine the difference between genders

```{r}
anova_result <- aov(as.numeric(Class.ASD) ~ as.factor(gender), dt)
```

```{r}
summary(anova_result)
```
The ANOVA results indicate a statistically significant difference in the number of autism diagnoses between genders (p-value = 0.033). 

```{r}
ggplot(dt, aes(
    x = factor(gender, levels=c("f", "m"), labels=c("Female", "Male")), 
    fill = factor(Class.ASD, levels=c(0, 1), labels=c("Non-autistic", "Autistic")))) + 
  geom_bar(position = "stack") +
  labs(
    x = "",
    fill = "",
    title = "Distribution of autism diagnoses between genders"
  )
```
The graph indicates that among participants women were statistically more likely to be diagnosed with autism compared to men.

## Do males and females differ in their average AQ-10 total scores?

Perform ANOVA test:
```{r}
anova_result <- aov(as.numeric(result) ~ as.factor(gender), dt)
```

```{r}
summary(anova_result)
```

There is no statistically significant difference in the distribution of results between genders (p = 0.263). 

```{r}
ggplot(dt, aes(x="", y=result, fill=factor(gender, levels=c("f", "m"), labels=c("Female", "Male")))) +
  geom_boxplot() +
  facet_wrap(~gender) +
  labs(
    fill="Gender",
    x="",
    title="AQ-10 total scores distribution among all participants"
  )
```

```{r}
ggplot(dt, aes(x=result, fill=factor(gender, levels=c("f", "m"), labels=c("Female", "Male")))) +
  geom_histogram(position = "dodge") +
  labs(
    fill="Gender",
    title="AQ-10 total scores distribution among all participants"
  )
```
The plots illustrate that although the third quartile (Q3) for women is slightly higher - indicating that women tend to achieve marginally higher scores - the median scores are comparable across genders.

## Does the prevalence of autism vary across different ethnic groups?

```{r}
unique(dt$ethnicity)
```


Remove groups "Others", "others" and "?"
```{r}
filteredDT <- dt[ethnicity != "Others" & ethnicity != "?" & ethnicity != "others"]
```

```{r}
dim(filteredDT)
```

Perform ANOVA test:
```{r}
anova_result <- aov(as.numeric(result) ~ as.factor(ethnicity), filteredDT)
```

```{r}
summary(anova_result)
```
The results of the ANOVA test indicate statistical significance in the distribution of results across ethnic groups (marked as ***).

```{r}
filteredDT[, .(
  meanResult = mean(result),
  minResult = min(result),
  maxResult = max(result),
  medianResult = median(result),
  numberOfParticipants = .N
  ), by=ethnicity][order(-meanResult)]
```


```{r}
ggplot(filteredDT, aes(x="", y=result, fill=factor(ethnicity))) +
  geom_boxplot() +
  facet_wrap(~ethnicity) +
  labs(
    fill="Ethnic group",
    x="",
    title="AQ-10 total scores distribution among all participants"
  )
```
Further analysis indicated that participants identifying as Latino, White-European, and Black achieved the highest scores on the AQ10 screening, whereas those identifying as Pacifica, South Asian, and Middle Eastern obtained the lowest scores, suggesting they are less likely to score high on the autism screening test.

## Is having a family history of autism associated with higher AQ-10 scores?

```{r}
dt[]
```


Perform ANOVA test:
```{r}
dt$austim <- as.factor(dt$austim)
```

```{r}
unique(dt$austim)
```

```{r}
anova_result <- aov(as.numeric(result) ~ as.factor(austim), data = dt)
```

```{r}
summary(anova_result)
```
The results of the ANOVA test indicate statistical significance of the family history of autism (marked as ***).

```{r}
dt[, .(
  meanResult = mean(result),
  minResult = min(result),
  maxResult = max(result),
  medianResult = median(result),
  numberOfParticipants = .N
  ), by=austim][order(-meanResult)]
```

```{r}
ggplot(filteredDT, aes(x="", y=result, fill=factor(austim))) +
  geom_boxplot() +
  facet_wrap(~austim) +
  labs(
    fill="Family history",
    x="",
    title="Scores distribution among participants with and without family history"
  )
```

# Summary

The analysis explored factors associated with autism and AQ-10 screening results. Among the individual AQ-10 items, A6 (“I know how to tell if someone listening to me is getting bored”) and A9 (“I find it easy to work out what someone is thinking or feeling just by looking at their face”) showed the strongest correlation with autism diagnosis. In contrast, A8 (“I like to collect information about categories or things”) was the least significant question in relation to autism scores.

No statistically significant difference was found between genders in the distribution of autism diagnoses or overall AQ-10 scores, although women were slightly more represented among those diagnosed.

Ethnicity showed a significant effect: participants identifying as Latino, White-European, or Black tended to achieve higher AQ-10 scores, while those identifying as Middle Eastern, South Asian, or Pacifica had lower scores, indicating a lower likelihood of scoring high on the autism screening.

Finally, a strong association was observed between family history of autism and higher AQ-10 results, with ANOVA confirming this factor as highly significant.
